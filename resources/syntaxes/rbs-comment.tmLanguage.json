{
  "scopeName": "rbs.sig.comment",
  "injectionSelector": "L:source.ruby",
  "patterns": [
    { "include": "#sig-comment" }
  ],

  "repository": {
    "rbs-annotations": {
      "patterns": [
        {
          "match": "@(abstract|final|interface|requires_ancestor|sealed)\\b",
          "name": "storage.modifier.annotation.rbs"
        }
      ]
    },

    "rbs-identifiers": {
      "patterns": [
        {
          "match": "(?<!@)\\b[a-z_][A-Za-z0-9_]*\\b",
          "name": "variable.other.rbs"
        }
      ]
    },

    "rbs-keywords": {
      "patterns": [
        {
          "match": "\\b(alias|type)\\b",
          "name": "keyword.control.rbs"
        }
      ]
    },

    "rbs-op-modifiers": {
      "patterns": [
        { "match": "\\*", "name": "keyword.operator.splat.rbs" },
        { "match": "\\?", "name": "keyword.operator.optional.rbs" }
      ]
    },

    "rbs-op-return": {
      "patterns": [
        {
          "match": "->",
          "name": "keyword.operator.return-type.rbs"
        }
      ]
    },

    "rbs-op-union-intersection": {
      "patterns": [
        { "match": "&", "name": "keyword.operator.intersection.rbs" },
        { "match": "\\|", "name": "keyword.operator.union.rbs" }
      ]
    },

    "rbs-punctuation": {
      "patterns": [
        { "match": ",", "name": "punctuation.separator.comma.rbs" },
        { "match": ":", "name": "punctuation.separator.key-value.rbs" },
        { "match": "\\(|\\)", "name": "punctuation.section.parens.rbs" },
        { "match": "\\{|\\}", "name": "punctuation.section.braces.rbs" },
        { "match": "\\[|\\]", "name": "punctuation.section.brackets.rbs" }
      ]
    },

    "rbs-records": {
      "begin": "\\{",
      "beginCaptures": {
        "0": { "name": "punctuation.section.braces.rbs" }
      },
      "end": "\\}",
      "endCaptures": {
        "0": { "name": "punctuation.section.braces.rbs" }
      },
      "name": "meta.type.record.rbs",
      "patterns": [
        {
          "match": "\\b[a-z_][A-Za-z0-9_]*(?=:)\\b",
          "name": "variable.other.property.rbs"
        },
        { "include": "#rbs-identifiers" },
        { "include": "#rbs-keywords" },
        { "include": "#rbs-op-modifiers" },
        { "include": "#rbs-op-union-intersection" },
        { "include": "#rbs-punctuation" },
        { "include": "#rbs-type-builtin" },
        { "include": "#rbs-type-const" }
      ]
    },

    "rbs-tuples": {
      "begin": "\\(",
      "beginCaptures": {
        "0": { "name": "punctuation.section.parens.rbs" }
      },
      "end": "\\)",
      "endCaptures": {
        "0": { "name": "punctuation.section.parens.rbs" }
      },
      "name": "meta.type.tuple.rbs",
      "patterns": [
        { "include": "#rbs-identifiers" },
        { "include": "#rbs-keywords" },
        { "include": "#rbs-op-modifiers" },
        { "include": "#rbs-op-union-intersection" },
        { "include": "#rbs-punctuation" },
        { "include": "#rbs-type-builtin" },
        { "include": "#rbs-type-const" }
      ]
    },

    "rbs-type-builtin": {
      "patterns": [
        {
          "match": "\\b(any|bool|nil|self|untyped|void)\\b",
          "name": "support.type.builtin.rbs"
        }
      ]
    },

    "rbs-type-const": {
      "patterns": [
        {
          "match": "\\b[A-Z][A-Za-z0-9_]*(?:::[A-Z][A-Za-z0-9_]*)*\\b",
          "name": "entity.name.type.rbs"
        }
      ]
    },

    "sig-comment": {
      "begin": "(?<!\\S)#:",
      "beginCaptures": {
        "0": { "name": "comment.line.sig.rbs" }
      },
      "end": "$",
      "name": "meta.sig.rbs",
      "patterns": [
        { "include": "#rbs-annotations" },
        { "include": "#rbs-identifiers" },
        { "include": "#rbs-keywords" },
        { "include": "#rbs-op-modifiers" },
        { "include": "#rbs-op-return" },
        { "include": "#rbs-op-union-intersection" },
        { "include": "#rbs-punctuation" },
        { "include": "#rbs-records" },
        { "include": "#rbs-tuples" },
        { "include": "#rbs-type-builtin" },
        { "include": "#rbs-type-const" }
      ]
    }
  }
}